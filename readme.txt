# PHP7+MySQL5.6 查立得源码授权系统DNS验证版

## 一、系统概述
本系统是一个基于PHP7和MySQL5.6的源码授权系统，使用DNS TXT记录验证域名所有权，实现对软件源码的授权保护。
系统支持多版本管理，可以灵活配置不同版本的价格和下载路径，管理员可以查看和管理授权记录。

## 二、环境要求
1. PHP版本：PHP 7.1及以上
2. MySQL版本：MySQL 5.6及以上
3. PHP扩展：mysqli、json
4. 文件目录权限：inc目录和adm目录需要可写权限

## 三、安装步骤
1. 将所有文件上传到网站根目录
2. 修改inc/conn.php文件中的数据库连接信息
3. 访问http://您的域名/install.php进行安装
4. 根据界面提示完成安装
5. 安装完成后，请删除install.php文件以确保系统安全

## 四、默认账户和密码
- 管理员账号：admin
- 管理员密码：123456
- 请在登录后立即修改默认密码

## 五、文件结构及功能说明
```
├── index.php             # 前台首页，包含授权查询和获取授权功能
├── admin.php             # 后台管理入口
├── install.php           # 安装程序
├── readme.txt            # 使用说明文档
├── inc/                  # 公共文件目录
│   ├── conn.php          # 数据库连接和系统配置
│   ├── sqls.php          # 数据库操作类
│   ├── pubs.php          # 公共PHP函数
│   ├── pubs.js           # 公共JavaScript函数
│   ├── pubs.css          # 公共CSS样式
│   ├── banben.json       # 版本配置文件
│   ├── mima.php          # 管理员账号密码文件（安装时自动创建）
│   └── json.php          # 网站设置文件（安装时自动创建）
└── adm/                  # 后台功能模块目录
    ├── lima.php          # 授权列表管理
    ├── site.php          # 网站设置
    ├── pass.php          # 修改密码
    └── lgout.php         # 退出登录
```

## 六、数据库结构

### auth_codes（授权码表）
| 字段名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| id | int(11) | 是 | 自增主键 |
| auth_code | varchar(32) | 是 | 授权码，MD5值 |
| domain | varchar(255) | 是 | 域名，唯一 |
| version | varchar(50) | 是 | 版本代码 |
| mobile | varchar(20) | 是 | 手机号 |
| email | varchar(100) | 是 | 邮箱 |
| status | varchar(20) | 是 | 授权状态：待授权、未授权、已授权 |
| created_time | datetime | 是 | 创建时间 |
| last_query_time | datetime | 是 | 最后查询时间 |

## 七、使用流程

### 1. 用户申请授权
1. 用户访问首页，点击"获取授权"标签
2. 填写域名、手机号、邮箱，选择需要的版本
3. 提交申请后，系统会生成授权码
4. 用户需要在自己的域名DNS中添加TXT记录，记录值为授权码

### 2. 验证授权状态
1. 用户访问首页，点击"授权查询"标签
2. 输入域名进行查询
3. 系统会检查域名对应的TXT记录是否匹配授权码
4. 如果匹配，则显示已授权，并提供下载链接
5. 如果不匹配，则显示未授权

### 3. 管理员操作
1. 访问http://您的域名/admin.php登录后台
2. 可以查看和管理所有授权记录
3. 可以修改域名、版本和授权状态
4. 可以删除授权记录
5. 可以设置网站标题、底部文字等信息
6. 可以修改管理员密码

## 八、注意事项
1. 授权码是基于域名和版本代码生成的MD5值，域名或版本变更后，授权码会改变
2. DNS TXT记录生效可能需要一段时间（一般5分钟到24小时不等）
3. 用户必须保留TXT记录，否则授权状态会变为未授权
4. 安装完成后请删除install.php文件
5. 请定期备份数据库
6. 请及时修改默认管理员密码

## 九、授权算法说明
授权码生成算法：MD5(版本代码 + 公共密钥 + 域名)
公共密钥在inc/conn.php文件中设置，默认为"DNSAuthKey20250530"(首用修改后续不改)
用户需要将授权码添加为域名的TXT记录，系统会验证TXT记录是否匹配

## 十、联系方式
作者邮箱：15058593138@qq.com
微信/手机：15058593138
